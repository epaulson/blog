<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Erik Paulson">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Deriving "Precinct" level results for Wisconsin | Erik Paulson's Blog</title>

        <link rel="alternate" type="application/atom+xml" title="Erik Paulson's Blog blog atom feed" href="/feeds/all.atom.xml" />
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <style>.codehilite .hll { background-color: #404040 }
.codehilite .c { color: #999999; font-style: italic } /* Comment */
.codehilite .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.codehilite .g { color: #d0d0d0 } /* Generic */
.codehilite .k { color: #6ab825; font-weight: bold } /* Keyword */
.codehilite .l { color: #d0d0d0 } /* Literal */
.codehilite .n { color: #d0d0d0 } /* Name */
.codehilite .o { color: #d0d0d0 } /* Operator */
.codehilite .x { color: #d0d0d0 } /* Other */
.codehilite .p { color: #d0d0d0 } /* Punctuation */
.codehilite .cm { color: #999999; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #cd2828; font-weight: bold } /* Comment.Preproc */
.codehilite .c1 { color: #999999; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #e50808; font-weight: bold; background-color: #520000 } /* Comment.Special */
.codehilite .gd { color: #d22323 } /* Generic.Deleted */
.codehilite .ge { color: #d0d0d0; font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #d22323 } /* Generic.Error */
.codehilite .gh { color: #ffffff; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #589819 } /* Generic.Inserted */
.codehilite .go { color: #cccccc } /* Generic.Output */
.codehilite .gp { color: #aaaaaa } /* Generic.Prompt */
.codehilite .gs { color: #d0d0d0; font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #ffffff; text-decoration: underline } /* Generic.Subheading */
.codehilite .gt { color: #d22323 } /* Generic.Traceback */
.codehilite .kc { color: #6ab825; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #6ab825; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #6ab825; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #6ab825 } /* Keyword.Pseudo */
.codehilite .kr { color: #6ab825; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #6ab825; font-weight: bold } /* Keyword.Type */
.codehilite .ld { color: #d0d0d0 } /* Literal.Date */
.codehilite .m { color: #3677a9 } /* Literal.Number */
.codehilite .s { color: #ed9d13 } /* Literal.String */
.codehilite .na { color: #bbbbbb } /* Name.Attribute */
.codehilite .nb { color: #24909d } /* Name.Builtin */
.codehilite .nc { color: #447fcf; text-decoration: underline } /* Name.Class */
.codehilite .no { color: #40ffff } /* Name.Constant */
.codehilite .nd { color: #ffa500 } /* Name.Decorator */
.codehilite .ni { color: #d0d0d0 } /* Name.Entity */
.codehilite .ne { color: #bbbbbb } /* Name.Exception */
.codehilite .nf { color: #447fcf } /* Name.Function */
.codehilite .nl { color: #d0d0d0 } /* Name.Label */
.codehilite .nn { color: #447fcf; text-decoration: underline } /* Name.Namespace */
.codehilite .nx { color: #d0d0d0 } /* Name.Other */
.codehilite .py { color: #d0d0d0 } /* Name.Property */
.codehilite .nt { color: #6ab825; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #40ffff } /* Name.Variable */
.codehilite .ow { color: #6ab825; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #666666 } /* Text.Whitespace */
.codehilite .mf { color: #3677a9 } /* Literal.Number.Float */
.codehilite .mh { color: #3677a9 } /* Literal.Number.Hex */
.codehilite .mi { color: #3677a9 } /* Literal.Number.Integer */
.codehilite .mo { color: #3677a9 } /* Literal.Number.Oct */
.codehilite .sb { color: #ed9d13 } /* Literal.String.Backtick */
.codehilite .sc { color: #ed9d13 } /* Literal.String.Char */
.codehilite .sd { color: #ed9d13 } /* Literal.String.Doc */
.codehilite .s2 { color: #ed9d13 } /* Literal.String.Double */
.codehilite .se { color: #ed9d13 } /* Literal.String.Escape */
.codehilite .sh { color: #ed9d13 } /* Literal.String.Heredoc */
.codehilite .si { color: #ed9d13 } /* Literal.String.Interpol */
.codehilite .sx { color: #ffa500 } /* Literal.String.Other */
.codehilite .sr { color: #ed9d13 } /* Literal.String.Regex */
.codehilite .s1 { color: #ed9d13 } /* Literal.String.Single */
.codehilite .ss { color: #ed9d13 } /* Literal.String.Symbol */
.codehilite .bp { color: #24909d } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #40ffff } /* Name.Variable.Class */
.codehilite .vg { color: #40ffff } /* Name.Variable.Global */
.codehilite .vi { color: #40ffff } /* Name.Variable.Instance */
.codehilite .il { color: #3677a9 } /* Literal.Number.Integer.Long */</style>
        <style>body{margin:0;padding:0;font:15px 'Source Sans Pro',sans-serif;line-height:1.6em;color:#222;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased}a{color:#007ee5;text-decoration:none}a:hover{color:#007ee5;text-decoration:none}header.main-header{background:none repeat scroll 0% 0% #2A66C0;margin-bottom:0px}header.main-header a{color:#fff}header.main-header .container{max-width:1000px}header.main-header .container nav a:hover{background-color:#2A66C0}article{margin:0}article header{margin-bottom:20px;padding-bottom:20px}article header h1{margin-bottom:2px;font-weight:700;color:#000}article header time{color:#9E9E9E;font-size:0.85em;float:right}article header time.left{color:#9E9E9E;font-size:0.85em;float:left}article p{font-size:16px;margin-bottom:20px;line-height:1.6em}article p.note{background:#f5f5f5;border:1px solid #ddd;padding:0.533em 0.733em}article p.update{background-color:#FEEFB3;border:1px solid #e6e68a;padding:0.533em 0.733em}article p.alert{background-color:#ffe2e2;border:1px solid #ffb2b2;padding:0.533em 0.733em}article ul,article ol{margin-top:0px;margin-bottom:25px}article li{font-size:16px;line-height:1.6em}article a:hover{text-decoration:underline}article blockquote{border-left:2px solid #c7c7cc;color:#666;margin:30px 0;padding:0 0 0 25px}article img{max-width:100%}article code{color:#333;background-color:#EEE;border-radius:0;font-size:13px}article .codehilite pre{border-radius:0;background-color:#202020;color:#d0d0d0}article .codehilite pre code{border:none}article .codehilite pre.bash{background-color:#000;color:#FFF}article .meta{font-size:11px}article .meta a:hover{text-decoration:none}article .meta div{margin-bottom:20px;display:block}article .meta a.tag{margin:0 10px 10px 0;padding:1px 12px;display:inline-block;font-size:12px;color:rgba(0,0,0,0.6);background:rgba(0,0,0,0.05)}article .meta a.tag:hover{background:rgba(0,0,0,0.15)}article .meta a.read_more,article .meta a.comments_btn{font-size:14px;font-weight:800;padding:10px 20px;color:#007EE5;background:#FFF;border:1px solid #007EE5}article .meta a.read_more:hover,article .meta a.comments_btn:hover{color:#FFF;background:#007EE5}.index{max-width:900px}.index article header h2{font-size:36px;margin-bottom:2px;font-weight:900}.index article header h2 a{color:#000}.index article header h2 a:hover{color:#007ee5;text-decoration:none}.index .separator{padding:40px 0 0 0;margin:0 0 40px 0;height:10px;border-bottom:solid 1px #CCC}.index .pagination{display:block;margin-bottom:100px}.index .pagination .left{text-align:right}.index .pagination .right{text-align:left}.index .pagination a{display:inline-block;border:2px solid #007EE5;margin:0 5px;padding:8px 20px;font-weight:bold;color:#007EE5}.index .pagination a:hover{color:#FFF;background:#007EE5}.post{max-width:900px}.post h2:before{content:"# ";font-weight:bold;color:#DDD}.post h3:before{content:"## ";font-weight:bold;color:#DDD}.post h4:before{content:"### ";font-weight:bold;color:#DDD}.post article .meta{margin:50px 0 100px}.list{max-width:900px}.list ul.double-list{margin:0 auto 60px;padding:0;list-style-type:none}.list ul.double-list li{padding:5px 0}.list ul.double-list li h2{font-size:1em;display:inline;font-weight:normal}.list ul.double-list li span{font-family:sans-serif;text-transform:uppercase;text-align:right;float:right;padding-top:3px;font-size:12px;color:#999}.full-width-content{padding-top:10px;padding-left:0px;padding-right:0px;margin-left:-20px;margin-right:-20px}.col-xs-1,.col-sm-1,.col-md-1,.col-lg-1,.col-xs-2,.col-sm-2,.col-md-2,.col-lg-2,.col-xs-3,.col-sm-3,.col-md-3,.col-lg-3,.col-xs-4,.col-sm-4,.col-md-4,.col-lg-4,.col-xs-5,.col-sm-5,.col-md-5,.col-lg-5,.col-xs-6,.col-sm-6,.col-md-6,.col-lg-6,.col-xs-7,.col-sm-7,.col-md-7,.col-lg-7,.col-xs-8,.col-sm-8,.col-md-8,.col-lg-8,.col-xs-9,.col-sm-9,.col-md-9,.col-lg-9,.col-xs-10,.col-sm-10,.col-md-10,.col-lg-10,.col-xs-11,.col-sm-11,.col-md-11,.col-lg-11,.col-xs-12,.col-sm-12,.col-md-12,.col-lg-12{padding-right:0px;padding-left:0px}</style>


        <meta property="og:title" content="Deriving &#34;Precinct&#34; level results for Wisconsin" />
        <meta property="og:type" content="article" />
        <meta property="og:image" content="images/350px-Wisconsin_Presidential_Election_Results_2016.svg.png" />
        <meta property="og:url" content="http://blog.unit1127.com/blog/2017/01/08/normalizing_reporting_units/" />
        <meta property="og:description" content="Wisconsin elections results are hard to map without some pre-processing. This Juypter Notebook goes through some of the steps required." />
        <meta property="og:locale" content="" />
        <meta property="og:site_name" content="Erik Paulson&#39;s Blog" />
        <meta property="article:published_time" content="2017-01-08" />
        <meta property="article:section" content="2017" />

    </head>

    <body>
        <header class="navbar navbar-static-top bs-docs-nav main-header">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="/" title="Home" class="title">Erik Paulson</a></li>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
                    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/about.html" title="About">About</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Deriving "Precinct" level results for Wisconsin</h1>
            <time datetime="article.date.isoformat()" pubdate>Sun 08 January 2017</time>
        </header>

        <div class="article_content">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Deriving-&quot;Precinct&quot;-level-results-for-Wisconsin">Deriving "Precinct" level results for Wisconsin<a class="anchor-link" href="#Deriving-&quot;Precinct&quot;-level-results-for-Wisconsin">&#182;</a></h1><h3 id="tl;dr:-Over-a-few-notebooks,-we'll-show-how-to-join-Wisconsin-election-results-to-ward(precinct)-shapefiles">tl;dr: Over a <a href="https://github.com/epaulson/WI_Reporting_To_GEOID">few notebooks</a>, we'll show how to join Wisconsin election results to ward(precinct) shapefiles<a class="anchor-link" href="#tl;dr:-Over-a-few-notebooks,-we'll-show-how-to-join-Wisconsin-election-results-to-ward(precinct)-shapefiles">&#182;</a></h3><blockquote><p>What we in Wisconsin call a ward is referred to as a precinct in some states or a voting district by the
Census Bureau. Wards do not constitute election districts from which municipal officials are elected, and
thus are not subject to the “one person, one vote” requirement which governs the formation of election
districts. Instead, wards are intended to serve as administrative subunits that are aggregated into election
districts of equal population. Cities, villages, and towns form municipal wards by combining whole
census blocks...Once established, wards serve as the building blocks used by the legislature, counties, and cities in redistricting their respective election districts. -- <a href="https://docs.legis.wisconsin.gov/misc/lrb/redistricting_information/guidelines_2020.pdf">Wisconsin Elections Commission</a></p>
</blockquote>
<p>The <a href="http://www.openelections.net">OpenElections Project</a> is compiling a set of standardized, precinct-level results for national and state level elections going back to 2000. It's a great project, and when finished the dataset will be very useful for journalists, academics, campaigns, and armchair political scientists.</p>
<p>The quality of the data OpenElections obtains varies greatly by state, and even within a state it can be an adventure - sometimes there's a nice spreadsheet in one county, but in some extreme cases volunteers have to go to County Clerk's offices and take photographs of election results and convert it by hand.</p>
<p>Wisconsin is on the easier end - The Wisconsin Elections Commission and its predecessor the Government Accountability Board have been good about <a href="http://elections.wi.gov/elections-voting/results">providing statewide election results</a> within a few weeks of an election, and in machine-readable formats, usually Excel. They're not consistent about the formatting of those Excel files but it's at least not too bad to reason about on a year-by-year basis.</p>
<p>Wards are the atomic base unit for most elections and all voters in a ward get the same ballot. (Well, mostly. See footnote at the bottom) Wards often have different polling places per ward, but in some cases multiple wards will vote at the same polling location. The districts built from the wards are not in a strict hierarchy: a State Assembly district made up of 50 wards might well be split by a Congressional district, with 25 wards in one district and 25 in another Congressional District. Wards are always contained in one County and in one municipality.</p>
<p>Because wards are built from whole Census blocks, demographic information is available for each ward.</p>
<p>Wards may get bigger or new wards may be created due to annexations and changes to municipal boundaries, but once created at the start of a new redistricting cycle, a ward is usually not deleted and they have stable ID numbers.  The Legislative Technology Services Bureau publishes a map and shapefiles for the wards and gives each ward an equivient of a FIPS code that can be used for a database/GIS join. The maps are published twice a year to reflect municipal boundary changes. Election results need to be paired with the current shapefile for best accuracy - using a 2016 shapefile with the 2012 election results will be off on the boundaries of muncipalities, though most wards will still look the same. (One exception: when the entire municipality is deleted, the LTSB stops including the old wards for it)</p>
<p>Unfortunately for Wisconsin election data users, while Wisconsin votes by ward, it does not necessarily report by ward. Only cities of greater than 35,000 people are required to report each ward individually. Smaller municipalites are permitted to combine results into <a href="http://elections.wi.gov/sites/default/files/publication/65/ea_wards_districts_reporting_units_annexations_f_18339.pdf">"reporting units"</a> of multiple wards. All wards in a reporting unit must share the same districts, and because different elections cover districts, the reporting units may vary every election, though they're typically the same. There are usually around 3600 reporting units per election, and in the 2014 fall election there were 6,634 wards in Wisconsin.</p>
<p>The "reporting units" do not get any sort of geographical identifier like a FIPS code. In the reported data collected by the Elections Commission, the reporting unit is an unstructured string. However, there is a prescribed format for <a href="http://elections.wi.gov/node/1298">how clerks should name reporting units</a> that in theory contains all of the information necessary to decide what wards are included in a reporting unit.</p>
<p>Sadly, the Reporting units are created by humans, and Wisconsin has 1,927 different clerks who are potentially creating reporting unit names, few of whom think about "how can a computer parse this", and not all of whom follow exactly the guidnance set out by the Elections Commission.</p>
<p>This notebook will first cover how to normalize reporting units. Then, we'll move on to joining GeoData. To normalize, we will use a mix of code and hand-editing to create a file that users of OpenElection data can reference, and lookup which wards (and which GeoIDs) are associated with a given row of the election results data. All of the notebooks can be found in a <a href="https://github.com/epaulson/WI_Reporting_To_GEOID">Github repo</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll start with the preliminaries - bring in Pandas and set some blogging-friendly defaults</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">999</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">999</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll start by bringing in the reporting units used for the Fall 2016 elections. Before we're done, we'll merge in reporting units from 2014 too - our end result will be a superset of multiple elections, but that's OK, if a reporting unit is named the same thing in different elections it will have the same wards.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reportingunits2016</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;http://elections.wi.gov/sites/default/files/page/2016_general_election_reporting_units_xlsx_79857.xlsx&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reportingunits2016</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adams County</td>
      <td>CITY OF ADAMS</td>
      <td>Ward 1-4</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adams County</td>
      <td>CITY OF WISCONSIN DELLS</td>
      <td>Wards 5,9</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adams County</td>
      <td>TOWN OF ADAMS</td>
      <td>Wards 1-3</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adams County</td>
      <td>TOWN OF BIG FLATS</td>
      <td>Ward 1-2</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adams County</td>
      <td>TOWN OF COLBURN</td>
      <td>Ward 1</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">reportingunits2016</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>3638</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We don't actually care about the different Districts in use here (we'll rediscover those in election results anyway.) The good clerks of Adams County above have done a nice job of following the instructions, and it looks like this might be relatively straightforward to parse with a regular expression. (You know what quote this calls for, of course)</p>
<blockquote><p>Some people, when confronted with a problem, think "I know, I'll use regular expressions." Now they have two problems. --jwz</p>
</blockquote>
<p>It will turn out that there are too many exceptions to reasonably parse with a regex, so we'll take the coward's way out: we'll parse a bunch with a regex, and just fix the rest by hand.</p>
<p>First, we'll try out our regex to try to cut the problem down to size. We'll blast over each row and then make a few new columns in our DataFrame</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_reporting_unit</span><span class="p">(</span><span class="n">ward</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;((?:^\D+)(?P&lt;hypen&gt;(\d+)(?:\s*)-(?:\s*)(\d+$)))|((?:^\D+)(?P&lt;single&gt;(\d+$)))|((?:^\D+)(?P&lt;amp&gt;(\d+)(?:\s*)&amp;(?:\s*)(\d+$)))|((?:^\D+)(?P&lt;comma&gt;(\d+)(?:\s*),(?:\s*)(\d+$)))&#39;</span><span class="p">,</span> <span class="n">ward</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;unmatched&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">ward</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;single&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;single&#39;</span><span class="p">)}</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;hypen&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hypen&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;hypen&#39;</span><span class="p">)}</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;amp&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;amp&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;amp&#39;</span><span class="p">)}</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;comma&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;comma&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;comma&#39;</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
        <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use this regex to add a few columns to our data, using a <a href="http://stackoverflow.com/questions/16236684/apply-pandas-function-to-column-to-create-multiple-new-columns">handy trick from StackOverflow for returning multiple columns from a single pandas row</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">reportingunits2016</span><span class="p">,</span><span class="n">reportingunits2016</span><span class="o">.</span><span class="n">ReportingUnit</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">process_reporting_unit</span><span class="p">(</span><span class="n">s</span><span class="p">)))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
      <th>data</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adams County</td>
      <td>CITY OF ADAMS</td>
      <td>Ward 1-4</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-4</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adams County</td>
      <td>CITY OF WISCONSIN DELLS</td>
      <td>Wards 5,9</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>5,9</td>
      <td>comma</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adams County</td>
      <td>TOWN OF ADAMS</td>
      <td>Wards 1-3</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-3</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adams County</td>
      <td>TOWN OF BIG FLATS</td>
      <td>Ward 1-2</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
      <td>1-2</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adams County</td>
      <td>TOWN OF COLBURN</td>
      <td>Ward 1</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
      <td>1</td>
      <td>single</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at a couple of examples</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="p">[</span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;hypen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
      <th>data</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adams County</td>
      <td>CITY OF ADAMS</td>
      <td>Ward 1-4</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-4</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adams County</td>
      <td>TOWN OF ADAMS</td>
      <td>Wards 1-3</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-3</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adams County</td>
      <td>TOWN OF BIG FLATS</td>
      <td>Ward 1-2</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
      <td>1-2</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adams County</td>
      <td>TOWN OF DELL PRAIRIE</td>
      <td>Ward 1-3</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-3</td>
      <td>hypen</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Adams County</td>
      <td>TOWN OF EASTON</td>
      <td>Wards 1-2</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-2</td>
      <td>hypen</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="p">[</span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;comma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
      <th>data</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Adams County</td>
      <td>CITY OF WISCONSIN DELLS</td>
      <td>Wards 5,9</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>5,9</td>
      <td>comma</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Brown County</td>
      <td>CITY OF DE PERE</td>
      <td>Wards 9,18</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 2</td>
      <td>State Senate - District 1</td>
      <td>9,18</td>
      <td>comma</td>
    </tr>
    <tr>
      <th>197</th>
      <td>Brown County</td>
      <td>VILLAGE OF HOWARD</td>
      <td>Wards 1,12</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 89</td>
      <td>State Senate - District 30</td>
      <td>1,12</td>
      <td>comma</td>
    </tr>
    <tr>
      <th>426</th>
      <td>Crawford County</td>
      <td>CITY OF PRAIRIE DU CHIEN</td>
      <td>Wards 2,7</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 96</td>
      <td>State Senate - District 32</td>
      <td>2,7</td>
      <td>comma</td>
    </tr>
    <tr>
      <th>616</th>
      <td>Dane County</td>
      <td>CITY OF VERONA</td>
      <td>Wards 1,5</td>
      <td>Congressional - District 2</td>
      <td>Assembly - District 79</td>
      <td>State Senate - District 27</td>
      <td>1,5</td>
      <td>comma</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And overall, 157 that are something funky. That's not too bad. Let's take a look at what a few of those look like:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>single       2198
hypen        1236
unmatched     157
comma          47
Name: type, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="p">[</span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;unmatched&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
      <th>data</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>173</th>
      <td>Brown County</td>
      <td>TOWN OF LEDGEVIEW</td>
      <td>Wards 1-3,8-10</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 88</td>
      <td>State Senate - District 30</td>
      <td>Wards 1-3,8-10</td>
      <td>unmatched</td>
    </tr>
    <tr>
      <th>198</th>
      <td>Brown County</td>
      <td>VILLAGE OF HOWARD</td>
      <td>Wards 2,8,11</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 4</td>
      <td>State Senate - District 2</td>
      <td>Wards 2,8,11</td>
      <td>unmatched</td>
    </tr>
    <tr>
      <th>199</th>
      <td>Brown County</td>
      <td>VILLAGE OF HOWARD</td>
      <td>Wards 3-4,6</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 89</td>
      <td>State Senate - District 30</td>
      <td>Wards 3-4,6</td>
      <td>unmatched</td>
    </tr>
    <tr>
      <th>202</th>
      <td>Brown County</td>
      <td>VILLAGE OF HOWARD</td>
      <td>Wards 9-10,18</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 4</td>
      <td>State Senate - District 2</td>
      <td>Wards 9-10,18</td>
      <td>unmatched</td>
    </tr>
    <tr>
      <th>205</th>
      <td>Brown County</td>
      <td>VILLAGE OF PULASKI</td>
      <td>Wards 1-3,6</td>
      <td>Congressional - District 8</td>
      <td>Assembly - District 6</td>
      <td>State Senate - District 2</td>
      <td>Wards 1-3,6</td>
      <td>unmatched</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yeah, let's not try to figure all those variations out. Let's just make ourselves a nice dictionary to edit.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(^\D+)&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="se">\&quot;</span><span class="s2">,&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="p">)</span>
    
<span class="n">junk</span> <span class="o">=</span> <span class="n">processed2016</span><span class="p">[</span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;unmatched&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ReportingUnit</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">convert</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#34;Wards 1-3,8-10&#34;: &#34;Wards &#34;,
&#34;Wards 2,8,11&#34;: &#34;Wards &#34;,
&#34;Wards 3-4,6&#34;: &#34;Wards &#34;,
&#34;Wards 9-10,18&#34;: &#34;Wards &#34;,
&#34;Wards 1-3,6&#34;: &#34;Wards &#34;,
&#34;Wards 7-8,10-12&#34;: &#34;Wards &#34;,
&#34;Wards 5-6,10&#34;: &#34;Wards &#34;,
&#34;Wards 7-9,14&#34;: &#34;Wards &#34;,
&#34;Ward 3A&#34;: &#34;Ward &#34;,
&#34;Ward 7A&#34;: &#34;Ward &#34;,
&#34;Wards 1-4,6-7&#34;: &#34;Wards &#34;,
&#34;Wards 1,9-10&#34;: &#34;Wards &#34;,
&#34;Wards 2-3,5&#34;: &#34;Wards &#34;,
&#34;Wards 4,6-8&#34;: &#34;Wards &#34;,
&#34;Wards 1-3,6&#34;: &#34;Wards &#34;,
&#34;Wards 15,18-19&#34;: &#34;Wards &#34;,
&#34;Wards 1-4,9&#34;: &#34;Wards &#34;,
&#34;Wards 3-4,12&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,4-5,7&#34;: &#34;Wards &#34;,
&#34;Ward 1,3,5&#34;: &#34;Ward &#34;,
&#34;Ward 2,4,6&#34;: &#34;Ward &#34;,
&#34;Ward 1,3-6,15&#34;: &#34;Ward &#34;,
&#34;Ward 7-10,12&#34;: &#34;Ward &#34;,
&#34;Wards 14,16-17&#34;: &#34;Wards &#34;,
&#34;Wards 1,5-6,11&#34;: &#34;Wards &#34;,
&#34;Wards 2-4,12&#34;: &#34;Wards &#34;,
&#34;Wards 1,3,5&#34;: &#34;Wards &#34;,
&#34;Wards 7,12-13&#34;: &#34;Wards &#34;,
&#34;Wards 1-4,7-11&#34;: &#34;Wards &#34;,
&#34;Wards 1,3-7&#34;: &#34;Wards &#34;,
&#34;Wards 1-6,22-24,29&#34;: &#34;Wards &#34;,
&#34;Wards 7-10,18-21,25-27,30&#34;: &#34;Wards &#34;,
&#34;Wards 11-17,28&#34;: &#34;Wards &#34;,
&#34;Wards 1-3,7-8&#34;: &#34;Wards &#34;,
&#34;Wards 4-6,9-12&#34;: &#34;Wards &#34;,
&#34;Wards 13-16,20-22&#34;: &#34;Wards &#34;,
&#34;Wards 17-19,30-32&#34;: &#34;Wards &#34;,
&#34;Ward 9B&#34;: &#34;Ward &#34;,
&#34;Ward 1A&#34;: &#34;Ward &#34;,
&#34;Ward 2-3,5&#34;: &#34;Ward &#34;,
&#34;Ward 1-5,10&#34;: &#34;Ward &#34;,
&#34;Wards 1-3,8&#34;: &#34;Wards &#34;,
&#34;Wards 5-6,9-10&#34;: &#34;Wards &#34;,
&#34;Wards 1-6,8&#34;: &#34;Wards &#34;,
&#34;Wards 3-4,22&#34;: &#34;Wards &#34;,
&#34;Wards 17-18,21,23-26&#34;: &#34;Wards &#34;,
&#34;Wards 19-20,27&#34;: &#34;Wards &#34;,
&#34;Wards 12,20-21,24&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,6-7&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,4-5&#34;: &#34;Wards &#34;,
&#34;Wards 1,3,5&#34;: &#34;Wards &#34;,
&#34;Wards 2,4,6&#34;: &#34;Wards &#34;,
&#34;Wards 1,3-5&#34;: &#34;Wards &#34;,
&#34;Ward 15A&#34;: &#34;Ward &#34;,
&#34;Ward 15B&#34;: &#34;Ward &#34;,
&#34;Ward 22A&#34;: &#34;Ward &#34;,
&#34;Ward 22B&#34;: &#34;Ward &#34;,
&#34;Wards 2,8S&#34;: &#34;Wards &#34;,
&#34;Ward 11S&#34;: &#34;Ward &#34;,
&#34;Wards 1S,3S&#34;: &#34;Wards &#34;,
&#34;Ward 1-2,5&#34;: &#34;Ward &#34;,
&#34;Ward 3-4,6&#34;: &#34;Ward &#34;,
&#34;Wards 13-18,20&#34;: &#34;Wards &#34;,
&#34;Ward 5B&#34;: &#34;Ward &#34;,
&#34;Wards 12-16,18&#34;: &#34;Wards &#34;,
&#34;Wards 17,19-20&#34;: &#34;Wards &#34;,
&#34;Wards 1A-3A&#34;: &#34;Wards &#34;,
&#34;Wards 1B-3B&#34;: &#34;Wards &#34;,
&#34;Wards 4-6,9-10&#34;: &#34;Wards &#34;,
&#34;Wards 1-3,5,7-8&#34;: &#34;Wards &#34;,
&#34;Wards 1,4-5,14&#34;: &#34;Wards &#34;,
&#34;Wards 2,6,8,12-13&#34;: &#34;Wards &#34;,
&#34;Wards 3,9-11&#34;: &#34;Wards &#34;,
&#34;Wards 5,7B&#34;: &#34;Wards &#34;,
&#34;Wards 6-7A&#34;: &#34;Wards &#34;,
&#34;Ward 5-6,10&#34;: &#34;Ward &#34;,
&#34;Wards 1-2,5&#34;: &#34;Wards &#34;,
&#34;Wards 1,6-7&#34;: &#34;Wards &#34;,
&#34;Ward 2A&#34;: &#34;Ward &#34;,
&#34;Ward 2B&#34;: &#34;Ward &#34;,
&#34;Wards 35,40,43&#34;: &#34;Wards &#34;,
&#34;Wards 36,38,41&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,4&#34;: &#34;Wards &#34;,
&#34;Ward 3S&#34;: &#34;Ward &#34;,
&#34;Wards 9-10,12-13&#34;: &#34;Wards &#34;,
&#34;Wards 11,14-15,17&#34;: &#34;Wards &#34;,
&#34;Wards 16,18-19&#34;: &#34;Wards &#34;,
&#34;Wards 1,17,20&#34;: &#34;Wards &#34;,
&#34;Wards 2-4,11&#34;: &#34;Wards &#34;,
&#34;Wards 9,13-14&#34;: &#34;Wards &#34;,
&#34;Wards 10,12,15-16&#34;: &#34;Wards &#34;,
&#34;Wards 19,21-22&#34;: &#34;Wards &#34;,
&#34;Wards 1-4,6&#34;: &#34;Wards &#34;,
&#34;Wards 1-3,13&#34;: &#34;Wards &#34;,
&#34;Wards 4,6,14&#34;: &#34;Wards &#34;,
&#34;Wards 5,7-9&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,9&#34;: &#34;Wards &#34;,
&#34;Wards 1-4,15&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,7-9,11-14&#34;: &#34;Wards &#34;,
&#34;Wards 3-6,10&#34;: &#34;Wards &#34;,
&#34;Wards 1-4,6&#34;: &#34;Wards &#34;,
&#34;Wards 6,9-10,15-17,20,23-25,28&#34;: &#34;Wards &#34;,
&#34;Wards 11-14,21-22,26-27&#34;: &#34;Wards &#34;,
&#34;Wards 9-10,32&#34;: &#34;Wards &#34;,
&#34;Wards 11-14,28&#34;: &#34;Wards &#34;,
&#34;Wards 23-24,26&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,8&#34;: &#34;Wards &#34;,
&#34;Wards 1,8,10-11&#34;: &#34;Wards &#34;,
&#34;Wards 2,5-7&#34;: &#34;Wards &#34;,
&#34;Wards 3-4,9,16-17&#34;: &#34;Wards &#34;,
&#34;Wards 1-5,7&#34;: &#34;Wards &#34;,
&#34;Wards 1-3,13&#34;: &#34;Wards &#34;,
&#34;Wards 1,3-4,10&#34;: &#34;Wards &#34;,
&#34;Wards 2,5-8&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,5-6&#34;: &#34;Wards &#34;,
&#34;Wards 1,3,5,9&#34;: &#34;Wards &#34;,
&#34;Wards 2,4,10&#34;: &#34;Wards &#34;,
&#34;Ward 1-3,7-9&#34;: &#34;Ward &#34;,
&#34;Ward 4-6,10-11&#34;: &#34;Ward &#34;,
&#34;Wards 1,7-8&#34;: &#34;Wards &#34;,
&#34;Wards 2-3,9-11&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,4&#34;: &#34;Wards &#34;,
&#34;Wards 3,6-7&#34;: &#34;Wards &#34;,
&#34;Wards 5,8-9&#34;: &#34;Wards &#34;,
&#34;Ward 1,8-11&#34;: &#34;Ward &#34;,
&#34;Wards 7,9-11&#34;: &#34;Wards &#34;,
&#34;Wards 3-4,8&#34;: &#34;Wards &#34;,
&#34;Wards 1A-2,4,7&#34;: &#34;Wards &#34;,
&#34;Ward 1B&#34;: &#34;Ward &#34;,
&#34;Wards 3,14-15,30&#34;: &#34;Wards &#34;,
&#34;Ward 5B&#34;: &#34;Ward &#34;,
&#34;Wards 5A-6,8-9,23-29,31-35,38&#34;: &#34;Wards &#34;,
&#34;Wards 10-13,21-22,36-37&#34;: &#34;Wards &#34;,
&#34;Ward 22B&#34;: &#34;Ward &#34;,
&#34;Ward 22A&#34;: &#34;Ward &#34;,
&#34;Ward 23A&#34;: &#34;Ward &#34;,
&#34;Ward 23B&#34;: &#34;Ward &#34;,
&#34;Ward 25A&#34;: &#34;Ward &#34;,
&#34;Ward 25B&#34;: &#34;Ward &#34;,
&#34;Ward 28B&#34;: &#34;Ward &#34;,
&#34;Ward 28A&#34;: &#34;Ward &#34;,
&#34;Ward 29A&#34;: &#34;Ward &#34;,
&#34;Ward 29B&#34;: &#34;Ward &#34;,
&#34;Wards 1-2,7-10&#34;: &#34;Wards &#34;,
&#34;Wards 1A,2-5&#34;: &#34;Wards &#34;,
&#34;Ward 1B&#34;: &#34;Ward &#34;,
&#34;Wards 1A-2&#34;: &#34;Wards &#34;,
&#34;Ward 1B&#34;: &#34;Ward &#34;,
&#34;Wards 1-2A&#34;: &#34;Wards &#34;,
&#34;Wards 2B,2C&#34;: &#34;Wards &#34;,
&#34;Wards 1-2,4,7&#34;: &#34;Wards &#34;,
&#34;Wards 3,5-6&#34;: &#34;Wards &#34;,
&#34;Wards 6,17,25-26&#34;: &#34;Wards &#34;,
&#34;Wards 7,16,27&#34;: &#34;Wards &#34;,
&#34;Wards 8,19,22-23&#34;: &#34;Wards &#34;,
&#34;Wards 6-15,24,26-29&#34;: &#34;Wards &#34;,
&#34;Wards 16-23,25&#34;: &#34;Wards &#34;,
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's cut and paste this into a new cell and just fix it by hand. You won't see me do this, but this is just the output from above manually edited.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">manual</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Wards 1-3,8-10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,8,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,8,11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,8,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3-4,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9-10,18&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,10,18&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7-8,10-12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,8,10,11,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5-6,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,6,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7-9,14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,8,9,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 3A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 3A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 7A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 7A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4,6-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,9-10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2-3,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4,6-8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 15,18-19&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 15,18,19&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4,9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3-4,12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,4-5,7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4,5,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1,3,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 2,4,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1,3-6,15&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,3,4,5,6,15&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 7-10,12&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 7,8,9,10,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 14,16-17&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 14,16,17&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,5-6,11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,5,6,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2-4,12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,4,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,3,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7,12-13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,12,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4,7-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,7,8,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,3-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,4,5,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-6,22-24,29&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,6,22,23,24,29&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7-10,18-21,25-27,30&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,8,9,10,18,19,20,21,25,26,27,30&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11-17,28&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,12,13,14,15,16,17,28&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,7-8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4-6,9-12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,5,6,9,10,11,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 13-16,20-22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 13,14,15,16,20,21,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 17-19,30-32&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 17,18,19,30,31,32&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 9B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 9B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 2-3,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1-5,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3,4,5,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5-6,9-10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,6,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-6,8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,6,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3-4,22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 17-18,21,23-26&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 17,18,21,23,24,25,26&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 19-20,27&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 19,20,27&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 12,20-21,24&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 12,20,21,24&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,6-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,4-5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,3,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,4,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,3-5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 15A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 15A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 15B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 15B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 22A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 22A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 22B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 22B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,8S&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,8S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 11S&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 11S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1S,3S&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1S,3S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1-2,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 3-4,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 13-18,20&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 13,14,15,16,17,18,20&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 5B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 5B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 12-16,18&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 12,13,14,15,16,18&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 17,19-20&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 17,19,20&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1A-3A&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1A,2A,3A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1B-3B&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1B,2B,3B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4-6,9-10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,5,6,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,5,7-8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,5,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,4-5,14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,4,5,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,6,8,12-13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,6,8,12,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3,9-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5,7B&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,7B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6-7A&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,7A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 5-6,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 5,6,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,6-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 2A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 2B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 35,40,43&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 35,40,43&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 36,38,41&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 36,38,41&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 3S&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 3S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9-10,12-13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,10,12,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11,14-15,17&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,14,15,17&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 16,18-19&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 16,18,19&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,17,20&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,17,20&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2-4,11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,4,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9,13-14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,13,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 10,12,15-16&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 10,12,15,16&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 19,21-22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 19,21,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4,6,14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,6,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5,7-9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,7,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4,15&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,15&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,7-9,11-14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,7,8,9,11,12,13,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3-6,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,5,6,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4,6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6,9-10,15-17,20,23-25,28&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,9,10,15,16,17,20,23,24,25,28&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11-14,21-22,26-27&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,12,13,14,21,22,26,27&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9-10,32&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,10,32&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11-14,28&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,12,13,14,28&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 23-24,26&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 23,24,26&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,8,10-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,8,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,5-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,5,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3-4,9,16-17&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,9,16,17&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-5,7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3,13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,3-4,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,4,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,5-8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,5,6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,5-6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,5,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,3,5,9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,5,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,4,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,4,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1-3,7-9&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3,7,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 4-6,10-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 4,5,6,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,7-8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2-3,9-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3,6-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5,8-9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1,8-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,8,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7,9-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3-4,8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1A-2,4,7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1A,2,4,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3,14-15,30&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,14,15,30&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 5B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 5B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5A-6,8-9,23-29,31-35,38&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5A,6,8,9,22,23,24,25,26,27,28,29,31,32,33,34,35,38&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 10-13,21-22,36-37&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 10,11,12,13,21,22,36,37&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 22B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 22B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 22A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 22A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 23A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 23A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 23B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 23B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 25A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 25A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 25B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 25B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 28B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 28B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 28A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 28A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 29A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 29A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 29B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 29B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,7-10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,7,8,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1A,2-5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1A,2,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1A-2&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1A,2&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2A&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2B,2C&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2B,2C&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2,4,7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3,5-6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,5,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6,17,25-26&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,17,25,26&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7,16,27&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,16,27&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 8,19,22-23&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 8,19,22,23&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6-15,24,26-29&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,7,8,9,10,11,12,13,14,15,24,26,27,28,29&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 16-23,25&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 16,17,18,19,20,21,22,23,25&quot;</span><span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can just blast over the Data Frame and create a new column, merging or expanding where necessary. If we were unmatched, look in the 'wardmappings' dictionary and return what we found there. The end results will be a column named 'mapped', which has every reporting unit converted to a comma seperated list.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">lookup</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">ward_mappings</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hypen&#39;</span><span class="p">:</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(\d+)(?:\s*)-(?:\s*)(\d+$)&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
        <span class="k">if</span><span class="p">(</span><span class="n">search</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;Wards </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;comma&#39;</span><span class="p">:</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(\d+)(?:\s*),(?:\s*)(\d+$)&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
        <span class="k">if</span><span class="p">(</span><span class="n">search</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;Wards </span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(\d+$)&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="s2">&quot;Ward </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;amp&#39;</span><span class="p">:</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(\d+)(?:\s*)&amp;(?:\s*)(\d+$)&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
        <span class="k">if</span><span class="p">(</span><span class="n">search</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;Wards </span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unmatched&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ward_mappings</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]]</span>
              
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;mapped&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed2016</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">lookup</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">manual</span><span class="p">,),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">processed2016</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
      <th>data</th>
      <th>type</th>
      <th>mapped</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adams County</td>
      <td>CITY OF ADAMS</td>
      <td>Ward 1-4</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-4</td>
      <td>hypen</td>
      <td>Wards 1,2,3,4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adams County</td>
      <td>CITY OF WISCONSIN DELLS</td>
      <td>Wards 5,9</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>5,9</td>
      <td>comma</td>
      <td>Wards 5,9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adams County</td>
      <td>TOWN OF ADAMS</td>
      <td>Wards 1-3</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 41</td>
      <td>State Senate - District 14</td>
      <td>1-3</td>
      <td>hypen</td>
      <td>Wards 1,2,3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adams County</td>
      <td>TOWN OF BIG FLATS</td>
      <td>Ward 1-2</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
      <td>1-2</td>
      <td>hypen</td>
      <td>Wards 1,2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adams County</td>
      <td>TOWN OF COLBURN</td>
      <td>Ward 1</td>
      <td>Congressional - District 3</td>
      <td>Assembly - District 72</td>
      <td>State Senate - District 24</td>
      <td>1</td>
      <td>single</td>
      <td>Ward 1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed2016</span><span class="p">[</span><span class="n">processed2016</span><span class="p">[</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Wards 1A-3A&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[16]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>County</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>CongressionalDistrict</th>
      <th>AssemblyDistrict</th>
      <th>SenateDistrict</th>
      <th>data</th>
      <th>type</th>
      <th>mapped</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2208</th>
      <td>Monroe County</td>
      <td>TOWN OF LA GRANGE</td>
      <td>Wards 1A-3A</td>
      <td>Congressional - District 7</td>
      <td>Assembly - District 70</td>
      <td>State Senate - District 24</td>
      <td>Wards 1A-3A</td>
      <td>unmatched</td>
      <td>Wards 1A,2A,3A</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's add in reporting units from the OpenElection Data. We'll start with 2014 data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">openelex2014</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/openelections/openelections-data-wi/master/2014/20141104__wi__general_ward.csv&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">openelex2014</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>ward</th>
      <th>office</th>
      <th>district</th>
      <th>total votes</th>
      <th>party</th>
      <th>candidate</th>
      <th>votes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adams</td>
      <td>Town Of Adams Wards 1-3</td>
      <td>Governor/Lieutenant Governor</td>
      <td>NaN</td>
      <td>500</td>
      <td>DEM</td>
      <td>Mary Burke John Lehman</td>
      <td>233</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adams</td>
      <td>Town Of Adams Wards 1-3</td>
      <td>Governor/Lieutenant Governor</td>
      <td>NaN</td>
      <td>500</td>
      <td>REP</td>
      <td>Scott Walker Rebecca Kleefisch</td>
      <td>258</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adams</td>
      <td>Town Of Adams Wards 1-3</td>
      <td>Governor/Lieutenant Governor</td>
      <td>NaN</td>
      <td>500</td>
      <td>IND</td>
      <td>Dennis Fehr No Candidate</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adams</td>
      <td>Town Of Adams Wards 1-3</td>
      <td>Governor/Lieutenant Governor</td>
      <td>NaN</td>
      <td>500</td>
      <td>IND</td>
      <td>Robert Burke Joseph M. Brost</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adams</td>
      <td>Town Of Adams Wards 1-3</td>
      <td>Governor/Lieutenant Governor</td>
      <td>NaN</td>
      <td>500</td>
      <td>IND</td>
      <td>Mary Jo Walters (Write-In)</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The OpenElection data is similar to Election Commission reporting units data, except they've combined the Ward and City into one column. Our end goal is a generic dictionary that can work on multiple years, so to keep the data consistent we're going to split that back into two columns.</p>
<p>Unfortunately, there are some odditities in the 2014 data, so we'll special-case those when we split data into municipalities and reporting units.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">openelex2014specialcases</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Village Of Gilman Ward&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Muni&quot;</span><span class="p">:</span> <span class="s2">&quot;Village of Gilman&quot;</span><span class="p">,</span> <span class="s2">&quot;ReportingUnit&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1&quot;</span><span class="p">},</span> <span class="s2">&quot;Village Of Lublin Ward&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Muni&quot;</span><span class="p">:</span> <span class="s2">&quot;Village of Lublin&quot;</span><span class="p">,</span> <span class="s2">&quot;ReportingUnit&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1&quot;</span><span class="p">}}</span>

<span class="k">def</span> <span class="nf">split_ward_col</span><span class="p">(</span><span class="n">ward</span><span class="p">,</span> <span class="n">special_cases</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">ward</span> <span class="ow">in</span> <span class="n">special_cases</span><span class="p">:</span>
      <span class="n">mcd</span> <span class="o">=</span> <span class="n">special_cases</span><span class="p">[</span><span class="n">ward</span><span class="p">][</span><span class="s1">&#39;Muni&#39;</span><span class="p">]</span>
      <span class="n">repounit</span> <span class="o">=</span> <span class="n">special_cases</span><span class="p">[</span><span class="n">ward</span><span class="p">][</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(.+?)(?P&lt;ward&gt;(?:Ward).*$)&#39;</span><span class="p">,</span> <span class="n">ward</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#print(ward)</span>
        <span class="c1">#some counties use Wd instead of Ward</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(.+?)(?P&lt;ward&gt;(?:Wd).*$)&#39;</span><span class="p">,</span> <span class="n">ward</span><span class="p">)</span>
      <span class="n">mcd</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="n">repounit</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;ward&#39;</span><span class="p">)</span>
    <span class="n">handled</span> <span class="o">=</span> <span class="n">process_reporting_unit</span><span class="p">(</span><span class="n">repounit</span><span class="p">)</span>
    <span class="n">handled</span><span class="p">[</span><span class="s1">&#39;Muni&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcd</span>
    <span class="n">handled</span><span class="p">[</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">repounit</span>
    <span class="k">return</span> <span class="n">handled</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">openelexprocessed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">openelex2014</span><span class="p">,</span><span class="n">openelex2014</span><span class="o">.</span><span class="n">ward</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">split_ward_col</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">openelex2014specialcases</span><span class="p">)))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The OpenElections data has a row for each candidate in each reporting unit, and for now we're just looking to compute ward infomration, so we'll drop some columns and make ourselves a copy that we can de-depulicate.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hack</span> <span class="o">=</span> <span class="n">openelexprocessed</span><span class="p">[[</span><span class="s1">&#39;county&#39;</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">,</span> <span class="s1">&#39;Muni&#39;</span><span class="p">,</span> <span class="s1">&#39;ReportingUnit&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dedupedOpenElex2014</span> <span class="o">=</span> <span class="n">hack</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As mentioned above, each election the reporting units might be different: depending on the ballots used and what's on the election, in one year a city might have a single reporting unit of wards 1,2,3,and 4, and the next year it might have two reporting units, one with wards 1 and 2, and the other with wards 3 and 4. So, we'll see if we've already got a reporting unit from 2016, and for everything we don't already have we'll build another manual dictionary. Hopefully, between the 2016 and the 2014 data, we'll have covered most possible combinations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dedupedOpenElex2014</span><span class="p">[</span><span class="n">dedupedOpenElex2014</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;unmatched&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>200</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">checkforexists</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">manual</span><span class="p">:</span>
        <span class="n">convert</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    
<span class="n">junk</span> <span class="o">=</span> <span class="n">dedupedOpenElex2014</span><span class="p">[</span><span class="n">dedupedOpenElex2014</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;unmatched&#39;</span><span class="p">][</span><span class="s1">&#39;ReportingUnit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">checkforexists</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#34;Wards 1-3, 8-10&#34;: &#34;Wards &#34;,
&#34;Wards 2, 8 &amp; 11&#34;: &#34;Wards &#34;,
&#34;Ward 3, 4 &amp; 6&#34;: &#34;Ward &#34;,
&#34;Ward 9, 10 &amp; 18&#34;: &#34;Ward &#34;,
&#34;Wards 1-3 &amp; 6&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3&#34;: &#34;Wards &#34;,
&#34;Wards 7-8, 10-12&#34;: &#34;Wards &#34;,
&#34;Ward 1, 2, 3&#34;: &#34;Ward &#34;,
&#34;Wards 1 - 5 &amp; 5S&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 2 &amp; 2 S&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 4, 6 - 7&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Ward 1, 2 &amp; 3&#34;: &#34;Ward &#34;,
&#34;Ward 1, 2, 3,&amp; 4&#34;: &#34;Ward &#34;,
&#34;Wards 1,9,10&#34;: &#34;Wards &#34;,
&#34;Wards 2,3,5&#34;: &#34;Wards &#34;,
&#34;Wards 4,6,7,8&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 3 &amp; 6&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 4, 5, 7&#34;: &#34;Wards &#34;,
&#34;Wards 1 And 2&#34;: &#34;Wards &#34;,
&#34;Ward 1, 3-6, 15&#34;: &#34;Ward &#34;,
&#34;Ward 7-10, 12&#34;: &#34;Ward &#34;,
&#34;Ward 1, 5, 6 &amp; 11&#34;: &#34;Ward &#34;,
&#34;Ward 2, 3, 4 &amp; 12&#34;: &#34;Ward &#34;,
&#34;Wards 15, 18, 19&#34;: &#34;Wards &#34;,
&#34;Wards 1-5, 8-9&#34;: &#34;Wards &#34;,
&#34;Wards 6-7, 14-18&#34;: &#34;Wards &#34;,
&#34;Wards 3 - 4, 12&#34;: &#34;Wards &#34;,
&#34;Wards 2,3,4&#34;: &#34;Wards &#34;,
&#34;Wards 1-4, 7-11&#34;: &#34;Wards &#34;,
&#34;Wards 1, 3-7&#34;: &#34;Wards &#34;,
&#34;Ward 1, 2, 3&#34;: &#34;Ward &#34;,
&#34;Wards 1, 3 &amp; 5&#34;: &#34;Wards &#34;,
&#34;Wards 7, 12 &amp; 13&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3, 4 &amp; 5&#34;: &#34;Wards &#34;,
&#34;Wards 1-6, 22-24, 29&#34;: &#34;Wards &#34;,
&#34;Wards 7-10, 18-21, 25-27, 30&#34;: &#34;Wards &#34;,
&#34;Wards 11-17, 28&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 3 And 7 - 8&#34;: &#34;Wards &#34;,
&#34;Wards 4 - 6 And 9 - 12&#34;: &#34;Wards &#34;,
&#34;Wards 13 - 16 And 20 - 22&#34;: &#34;Wards &#34;,
&#34;Wards 17 - 19 And 30 - 32&#34;: &#34;Wards &#34;,
&#34;Wards 23 - 26 And 27 - 29&#34;: &#34;Wards &#34;,
&#34;Wards 1 + 2&#34;: &#34;Wards &#34;,
&#34;Wards 3 + 4&#34;: &#34;Wards &#34;,
&#34;Wards 5 + 7&#34;: &#34;Wards &#34;,
&#34;Wards 8 + 9&#34;: &#34;Wards &#34;,
&#34;Wards 9B&#34;: &#34;Wards &#34;,
&#34;Wards 9, 9A, 10, 11 ,12&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3, 4, 5&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1-2-3&#34;: &#34;Wards &#34;,
&#34;Wards 1-2-3&#34;: &#34;Wards &#34;,
&#34;Wards 1-2-3-4&#34;: &#34;Wards &#34;,
&#34;Wards 1-2-3-4&#34;: &#34;Wards &#34;,
&#34;Wards 2,3 &amp; 5&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 5 &amp; 10&#34;: &#34;Wards &#34;,
&#34;Wards 5-6, 9, 12&#34;: &#34;Wards &#34;,
&#34;Wards 1,2,3 &amp; 8&#34;: &#34;Wards &#34;,
&#34;Wards 1 And 2&#34;: &#34;Wards &#34;,
&#34;Wards 3 And 4&#34;: &#34;Wards &#34;,
&#34;Wards 5 And 6&#34;: &#34;Wards &#34;,
&#34;Ward 1 - 6 &amp; 8&#34;: &#34;Ward &#34;,
&#34;Wards 3, 4, 22&#34;: &#34;Wards &#34;,
&#34;Wards 17 - 18, 21, 23 - 25&#34;: &#34;Wards &#34;,
&#34;Ward 1, 2 &amp; 3&#34;: &#34;Ward &#34;,
&#34;Wards 1, 2, 4, 5&#34;: &#34;Wards &#34;,
&#34;Wards 12, 20, 21, 24&#34;: &#34;Wards &#34;,
&#34;Wards 1,2,6 &amp; 7&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1, 3, 5&#34;: &#34;Wards &#34;,
&#34;Wards 2, 4, 6&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, &amp; 3&#34;: &#34;Wards &#34;,
&#34;Ward 1, 3 - 5&#34;: &#34;Ward &#34;,
&#34;Wards 1S &amp; 3S&#34;: &#34;Wards &#34;,
&#34;Wards - 1, 2 &amp; 5&#34;: &#34;Wards - &#34;,
&#34;Wards - 3, 4 &amp; 6&#34;: &#34;Wards - &#34;,
&#34;Wards 2, 8S&#34;: &#34;Wards &#34;,
&#34;Ward 1 B, 2 B, 3 B&#34;: &#34;Ward &#34;,
&#34;Ward 1 A, 2 A, 3 A&#34;: &#34;Ward &#34;,
&#34;Wards 1, 2 &amp; 3&#34;: &#34;Wards &#34;,
&#34;Wards 1-16, 5A, 18&#34;: &#34;Wards &#34;,
&#34;Wards 1-3 &amp;  5-8&#34;: &#34;Wards &#34;,
&#34;Wards 1, 4, 5, 14&#34;: &#34;Wards &#34;,
&#34;Wards 2, 6, 8, 12, 13&#34;: &#34;Wards &#34;,
&#34;Wards 3, 9, 10, 11&#34;: &#34;Wards &#34;,
&#34;Wd 1,2,5&#34;: &#34;Wd &#34;,
&#34;Ward 5, 7B&#34;: &#34;Ward &#34;,
&#34;Ward 6, 7A&#34;: &#34;Ward &#34;,
&#34;Ward 8, 9, 10&#34;: &#34;Ward &#34;,
&#34;Ward 19, 20, 21&#34;: &#34;Ward &#34;,
&#34;Wards 1, 2 &amp; 4&#34;: &#34;Wards &#34;,
&#34;Ward 1, 2, 3&#34;: &#34;Ward &#34;,
&#34;Wards 3, 4, 5&#34;: &#34;Wards &#34;,
&#34;Wards 6, 7, 8&#34;: &#34;Wards &#34;,
&#34;Wards 9, 10, 12, 13&#34;: &#34;Wards &#34;,
&#34;Wards 11, 14, 15, 17&#34;: &#34;Wards &#34;,
&#34;Wards 16, 18, 19&#34;: &#34;Wards &#34;,
&#34;Ward 1, 2, 4, 16&#34;: &#34;Ward &#34;,
&#34;Ward 3, 10, 11, 12, 15&#34;: &#34;Ward &#34;,
&#34;Ward 6, 7, 8, 9&#34;: &#34;Ward &#34;,
&#34;Ward 19, 21, 22, 23&#34;: &#34;Ward &#34;,
&#34;Wards 1-4, 6&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 4 &amp; 15&#34;: &#34;Wards &#34;,
&#34;Ward 1-3, 13&#34;: &#34;Ward &#34;,
&#34;Ward 4, 6, 14&#34;: &#34;Ward &#34;,
&#34;Ward 5, 7-9&#34;: &#34;Ward &#34;,
&#34;Wards 1-2 &amp; 9&#34;: &#34;Wards &#34;,
&#34;Wards 1,2,3,&#34;: &#34;Wards &#34;,
&#34;Wards 1- 4, 6&#34;: &#34;Wards &#34;,
&#34;Wards 5, 6, 10&#34;: &#34;Wards &#34;,
&#34;Ward 7 - 9, 11 - 14&#34;: &#34;Ward &#34;,
&#34;Wds 1,2,8&#34;: &#34;Wds &#34;,
&#34;Wds 3,4,5,6,7&#34;: &#34;Wds &#34;,
&#34;Wards 1,8,10 &amp; 11&#34;: &#34;Wards &#34;,
&#34;Wards 2,5,6 &amp; 7&#34;: &#34;Wards &#34;,
&#34;Wards 3,16,4,17 &amp; 9&#34;: &#34;Wards &#34;,
&#34;Wards 1 2&#34;: &#34;Wards &#34;,
&#34;Wards 5 6&#34;: &#34;Wards &#34;,
&#34;Wards 7 8 9&#34;: &#34;Wards &#34;,
&#34;Wards 6, 9, 10, 15 - 17, 20, 23&#34;: &#34;Wards &#34;,
&#34;Wards 11 - 14, 21, 22&#34;: &#34;Wards &#34;,
&#34;Wards 23-24, 26&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 3 - 4 - 10&#34;: &#34;Wards &#34;,
&#34;Wards 2 - 5 - 6 - 7 - 8&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 5, 6&#34;: &#34;Wards &#34;,
&#34;Wards 9, 10, 11&#34;: &#34;Wards &#34;,
&#34;Ward 1,3,5 &amp; 9&#34;: &#34;Ward &#34;,
&#34;Ward 2, 4 &amp; 10&#34;: &#34;Ward &#34;,
&#34;Ward 6,7 &amp; 8&#34;: &#34;Ward &#34;,
&#34;Wards 1, 2, 3, 7, 8, 9&#34;: &#34;Wards &#34;,
&#34;Wards 4, 5, 6, 10, 11&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 3, 7 - 11&#34;: &#34;Wards &#34;,
&#34;Wards 1,2,&amp; 4&#34;: &#34;Wards &#34;,
&#34;Wards 3,6,&amp; 7&#34;: &#34;Wards &#34;,
&#34;Wards  5,8,&amp; 9&#34;: &#34;Wards &#34;,
&#34;Ward 1, 8-11&#34;: &#34;Ward &#34;,
&#34;Wards 7, 9 - 11&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 3, 4&#34;: &#34;Wards &#34;,
&#34;Wards 2,3,4,5&#34;: &#34;Wards &#34;,
&#34;Wards 4 And 5&#34;: &#34;Wards &#34;,
&#34;Wards 9 And 10&#34;: &#34;Wards &#34;,
&#34;Wards 11 And 12&#34;: &#34;Wards &#34;,
&#34;Wards 13 And 14&#34;: &#34;Wards &#34;,
&#34;Wards 15 And 16&#34;: &#34;Wards &#34;,
&#34;Wards 3, 4 &amp; 8&#34;: &#34;Wards &#34;,
&#34;Wards 1 - 2 &amp; 7 - 10&#34;: &#34;Wards &#34;,
&#34;Wards 1, 2, 4, 7&#34;: &#34;Wards &#34;,
&#34;Wards 3, 5, 6&#34;: &#34;Wards &#34;,
&#34;Wards 1A, 2-5&#34;: &#34;Wards &#34;,
&#34;Ward 1A And 2&#34;: &#34;Ward &#34;,
&#34;Wards 1 And 2A&#34;: &#34;Wards &#34;,
&#34;Wards 2B And 2C&#34;: &#34;Wards &#34;,
&#34;Wards 1A, 2, 4, 7&#34;: &#34;Wards &#34;,
&#34;Wards 3, 14, 15, 30&#34;: &#34;Wards &#34;,
&#34;Wards 5A, 6, 8, 9, 23, 24, 25, 26, 27, 28, 29, 31&#34;: &#34;Wards &#34;,
&#34;Wards 10, 11, 12, 13, 21, 22&#34;: &#34;Wards &#34;,
&#34;Wards 8, 19, 22, 23&#34;: &#34;Wards &#34;,
&#34;Wards 6 - 15 &amp; 24 &amp; 26&#34;: &#34;Wards &#34;,
&#34;Wards 16 - 23 &amp; 25 &amp; 27&#34;: &#34;Wards &#34;,
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">manual2014</span> <span class="o">=</span> <span class="p">{</span>
<span class="s2">&quot;Wards 1-3, 8-10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,8,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2, 8 &amp; 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,8,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 3, 4 &amp; 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 9, 10 &amp; 18&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 9,10,18&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3 &amp; 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7-8, 10-12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,8,10,11,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 5 &amp; 5S&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,5S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 2 &amp; 2 S&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,2S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 4, 6 - 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2, 3,&amp; 4&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,9,10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,3,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4,6,7,8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 3 &amp; 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 4, 5, 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4,5,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 And 2&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 3-6, 15&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,3,4,5,6,15&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 7-10, 12&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 7,8,9,10,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 5, 6 &amp; 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,5,6,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 2, 3, 4 &amp; 12&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2,3,4,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 15, 18, 19&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 15,18,19&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-5, 8-9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6-7, 14-18&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,7,14,15,16,17,18&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3 - 4, 12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,3,4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4, 7-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,7,8,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 3-7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,4,5,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 3 &amp; 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7, 12 &amp; 13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,12,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3, 4 &amp; 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-6, 22-24, 29&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,6,22,23,24,29&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7-10, 18-21, 25-27, 30&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,8,9,10,18,19,20,21,25,26,27,30&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11-17, 28&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,12,13,14,15,16,17,28&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 3 And 7 - 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4 - 6 And 9 - 12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,5,6,9,10,11,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 13 - 16 And 20 - 22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 13,14,15,16,20,21,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 17 - 19 And 30 - 32&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 17,18,19,30,31,32&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 23 - 26 And 27 - 29&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 23,24,25,26,27,28,29&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 + 2&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3 + 4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5 + 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 8 + 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9B&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9, 9A, 10, 11 ,12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,9A,10,11,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3, 4, 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2-3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2-3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2-3-4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2-3-4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,3 &amp; 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 5 &amp; 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5-6, 9, 12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,6,9,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,2,3 &amp; 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 And 2&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3 And 4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5 And 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1 - 6 &amp; 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3,4,5,6,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3, 4, 22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 17 - 18, 21, 23 - 25&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 17,18,21,23,24,25&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 4, 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 12, 20, 21, 24&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 12,20,21,24&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,2,6 &amp; 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 3, 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2, 4, 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 3 - 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1S &amp; 3S&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1S,3S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards - 1, 2 &amp; 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards - 3, 4 &amp; 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2, 8S&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,8S&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1 B, 2 B, 3 B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1B,2B,3B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1 A, 2 A, 3 A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1A,2A,3A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-16, 5A, 18&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,5A,18&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-3 &amp;  5-8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,5,6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 4, 5, 14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,4,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2, 6, 8, 12, 13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,6,8,12,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3, 9, 10, 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wd 1,2,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 5, 7B&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 5,7B&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 6, 7A&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 6,7A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 8, 9, 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 8,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 19, 20, 21&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 19,20,21&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2 &amp; 4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2, 3&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3, 4, 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6, 7, 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9, 10, 12, 13&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,10,12,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11, 14, 15, 17&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,14,15,17&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 16, 18, 19&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 16,18,19&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 2, 4, 16&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3,16&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 3, 10, 11, 12, 15&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 3,10,11,12,15&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 6, 7, 8, 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 6,7,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 19, 21, 22, 23&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 19,21,22,23&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-4, 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 4 &amp; 15&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,15&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1-3, 13&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,2,3,13&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 4, 6, 14&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 4,6,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 5, 7-9&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 5,7,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1-2 &amp; 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,2,3,&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1- 4, 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5, 6, 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,6,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 7 - 9, 11 - 14&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 7,8,9,11,12,13,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wds 1,2,8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wds 3,4,5,6,7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,5,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,8,10 &amp; 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,8,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,5,6 &amp; 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,5,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3,16,4,17 &amp; 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,16,4,17,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 2&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7 8 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6, 9, 10, 15 - 17, 20, 23&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,9,10,15,16,17,20,23&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11 - 14, 21, 22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,12,13,14,21,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 23-24, 26&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 23,24,26&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 3 - 4 - 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,3,4,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2 - 5 - 6 - 7 - 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,5,6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 5, 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,5,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9, 10, 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1,3,5 &amp; 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,3,5,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 2, 4 &amp; 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 2,4,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 6,7 &amp; 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 6,7,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3, 7, 8, 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,7,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4, 5, 6, 10, 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,5,6,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 3, 7 - 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,7,8,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1,2,&amp; 4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3,6,&amp; 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,6,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards  5,8,&amp; 9&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5,8,9&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1, 8-11&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1,8,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 7, 9 - 11&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 7,9,10,11&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 3, 4&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,3,4&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2,3,4,5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 4 And 5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 9 And 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 11 And 12&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 11,12&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 13 And 14&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 13,14&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 15 And 16&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 15,16&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3, 4 &amp; 8&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,4,8&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 - 2 &amp; 7 - 10&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,7,8,9,10&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1, 2, 4, 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2,4,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3, 5, 6&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,5,6&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1A, 2-5&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1A,2,3,4,5&quot;</span><span class="p">,</span>
<span class="s2">&quot;Ward 1A And 2&quot;</span><span class="p">:</span> <span class="s2">&quot;Ward 1A,2&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1 And 2A&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1,2A&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 2B And 2C&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 2B,2C&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 1A, 2, 4, 7&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 1A,2,4,7&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 3, 14, 15, 30&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 3,14,15,30&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 5A, 6, 8, 9, 23, 24, 25, 26, 27, 28, 29, 31&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 5A,6,8,9,23,24,25,26,27,28,29,31&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 10, 11, 12, 13, 21, 22&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 10,11,12,13,21,22&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 8, 19, 22, 23&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 8,19,22,23&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 6 - 15 &amp; 24 &amp; 26&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 6,7,8,9,10,11,12,13,14,15,24,26&quot;</span><span class="p">,</span>
<span class="s2">&quot;Wards 16 - 23 &amp; 25 &amp; 27&quot;</span><span class="p">:</span> <span class="s2">&quot;Wards 16,17,18,19,20,21,22,23,25,27&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Merge the 2016 and 2014 data into one dictionary, and then let's normalize all of the 2014 reporting units.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">combinedmappings</span> <span class="o">=</span> <span class="n">manual</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">combinedmappings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">manual2014</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dedupedOpenElex2014</span><span class="p">[</span><span class="s1">&#39;mapped&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dedupedOpenElex2014</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">lookup</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">combinedmappings</span><span class="p">,),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dedupedOpenElex2014</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[28]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>ward</th>
      <th>Muni</th>
      <th>ReportingUnit</th>
      <th>data</th>
      <th>type</th>
      <th>mapped</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adams</td>
      <td>Town Of Adams Wards 1-3</td>
      <td>Town Of Adams</td>
      <td>Wards 1-3</td>
      <td>1-3</td>
      <td>hypen</td>
      <td>Wards 1,2,3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Adams</td>
      <td>Town Of Big Flats Wards 1 &amp; 2</td>
      <td>Town Of Big Flats</td>
      <td>Wards 1 &amp; 2</td>
      <td>1 &amp; 2</td>
      <td>amp</td>
      <td>Wards 1,2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Adams</td>
      <td>Town Of Colburn Ward 1</td>
      <td>Town Of Colburn</td>
      <td>Ward 1</td>
      <td>1</td>
      <td>single</td>
      <td>Ward 1</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Adams</td>
      <td>Town Of Dell Prairie Wards 1-3</td>
      <td>Town Of Dell Prairie</td>
      <td>Wards 1-3</td>
      <td>1-3</td>
      <td>hypen</td>
      <td>Wards 1,2,3</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Adams</td>
      <td>Town Of Easton Wards 1 &amp; 2</td>
      <td>Town Of Easton</td>
      <td>Wards 1 &amp; 2</td>
      <td>1 &amp; 2</td>
      <td>amp</td>
      <td>Wards 1,2</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Adams</td>
      <td>Town Of Jackson Wards 1 &amp; 2</td>
      <td>Town Of Jackson</td>
      <td>Wards 1 &amp; 2</td>
      <td>1 &amp; 2</td>
      <td>amp</td>
      <td>Wards 1,2</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Adams</td>
      <td>Town Of Leola Ward 1</td>
      <td>Town Of Leola</td>
      <td>Ward 1</td>
      <td>1</td>
      <td>single</td>
      <td>Ward 1</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Adams</td>
      <td>Town Of Lincoln Ward 1</td>
      <td>Town Of Lincoln</td>
      <td>Ward 1</td>
      <td>1</td>
      <td>single</td>
      <td>Ward 1</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Adams</td>
      <td>Town Of Monroe Ward 1</td>
      <td>Town Of Monroe</td>
      <td>Ward 1</td>
      <td>1</td>
      <td>single</td>
      <td>Ward 1</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Adams</td>
      <td>Town Of New Chester Ward 1-3</td>
      <td>Town Of New Chester</td>
      <td>Ward 1-3</td>
      <td>1-3</td>
      <td>hypen</td>
      <td>Wards 1,2,3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's write out our combined special-case mappings for later. This dictionary will have both 2016 and 2014 data, but when we want to add 2012 data hopefully we'll be able to use it as a starting point.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ward_mappings.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">special_case_output</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">combinedmappings</span><span class="p">,</span> <span class="n">special_case_output</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's also write out a copy of a CSV with normalized wards. This is only the 2014 data, and can be used as a lookup table for the real Open Elections data, which we'll do in our next notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dedupedOpenElex2014</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;2014_wards_normalized.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;county&#39;</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">,</span> <span class="s1">&#39;Muni&#39;</span><span class="p">,</span> <span class="s1">&#39;ReportingUnit&#39;</span><span class="p">,</span> <span class="s1">&#39;mapped&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>*</em> One note about wards. Earlier, we said that all voters in a ward get the same ballot. This is not true in the case of school board elections. School district boundaries do not follow municipal boundaries, so some wards are split between different districts. The Elections Commission calls these 'District Combos', and the Voter Registration system records which District Combo a voter lives in and which ballot they should get. (In fact, not only do school district boundaries not follow municipal boundaries, they don't even follow parcel boundaries. There are a few condos in Madison where the School District boundary runs through the condo. In that case, for purposes of "residency", the district that the bedroom falls into decides which district the voter lives in.)</p>
<p><br/>
<br/>
<br/></p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


<p>This post was written entirely in the IPython notebook. You can <a href="https://github.com/epaulson/WI_Reporting_To_GEOID/blob/master/NormalizingReportingUnits.ipynb">download</a> this notebook, or see a static view on <a href="http://nbviewer.ipython.org/url/github.com/epaulson/WI_Reporting_To_GEOID/blob/master/NormalizingReportingUnits.ipynb">nbviewer</a>. The Facebook graphic courtesty of <a href="https://en.wikipedia.org/wiki/United_States_presidential_election_in_Wisconsin,_2016#/media/File:Wisconsin_Presidential_Election_Results_2016.svg">Wikipedia</a> under a CC-BY-SA license</p>
        </div>

        <div class="meta">
            <div>
            </div>
        </div>
    </article>
</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>
    </body>
</html>